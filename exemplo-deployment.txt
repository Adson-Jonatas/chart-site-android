apiVersion: apps/v1
kind: Deployment
metadata:
  name: blog
  labels:
    app: blog
spec:
  replicas: 3
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 1
      selector:
        matchLabels:
          app: blog
      template:
        metadata:
          labels:
            app: blog
        spec:
          containers:
            - name: blog
              image: gasparbarancelli/blog:1.0
              imagePullPolicy: Always
              readinessProbe:
                httpGet:
                  path: /actuator/health
                  port: 8080
                initialDelaySeconds: 60
                periodSeconds: 10
                timeoutSeconds: 10
              livenessProbe:
                httpGet:
                  path: /actuator/health
                  port: 8080
                initialDelaySeconds: 60
                periodSeconds: 60
                timeoutSeconds: 10
                successThreshold: 1
                failureThreshold: 2
              resources:
                requests:
                  memory: "300Mi"
                  cpu: "400m"
                limits:
                  memory: "700Mi"
                  cpu: "600m"
              ports:
                - containerPort: 8080
